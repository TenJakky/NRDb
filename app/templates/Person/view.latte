{layout ../@layout.latte}
{block title}{$data->name} {$data->surname}{/block}
{block head}{/block}
{block content}

<section>
    <ul class="inline-buttons">
        <li>
            <a href="{plink Person:edit $data->id}">Edit details</a>
        </li>
    </ul>
</section>
<section>
    <table class="list">
        <tr>
            <th>Nationality</th>
            <td>{$data->ref('country', 'country_id')->name}</td>
        </tr>
        <tr>
            <th>Born</th>
            <td>{$data->born|date:'%d.%m.%Y'}</td>
        </tr>
        <tr>
            <th>Died</th>
            <td>{$data->died|date:'%d.%m.%Y'}</td>
        </tr>
        <tr>
            <th>Bio</th>
            <td>{$data->bio}</td>
        </tr>
    </table>
</section>
<section>
    <table class="grid">
        <thead>
            <tr>
                <th>
                    Name
                </th>
                <th>
                    Rating
                </th>
                <th>
                    Year
                </th>
            </tr>
        </thead>
        <tbody>
        {foreach $data->related('movie2director.person_id') as $row}
        {var movie => $row->ref('movie', 'movie_id')}
            <tr>
                <td>
                    <a href="{plink Movie:view $movie->id}">{$movie->original_title}</a>
                </td>
                <td>
                    {$ratingMovieModel->getRating($movie->id)|number:2}
                </td>
                <td>
                    {$movie->year}
                </td>
            </tr>
        {/foreach}
        </tbody>
    </table>
</section>